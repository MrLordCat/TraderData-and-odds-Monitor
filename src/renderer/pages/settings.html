<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
	<meta charset="utf-8" />
	<title>Settings</title>
	<link rel="stylesheet" href="../styles/m3-tokens.css" />
	<link rel="stylesheet" href="../styles/m3-theme-transitions.css" />
	<link rel="stylesheet" href="../styles/m3-components.css" />
	<link rel="stylesheet" href="../styles/common.css" />
	<link rel="stylesheet" href="../styles/settings.css" />
</head>
<body>
	<div id="backdrop"></div>
	<div class="panel" role="dialog" aria-modal="true" aria-labelledby="title">
		<div class="head">
			<h1 id="title">Settings <small id="version-label" style="opacity:0.5;font-weight:normal"></small></h1>
			<button id="close" class="x">‚úï</button>
		</div>

		<!-- Tab bar -->
		<nav class="tab-bar" role="tablist" aria-label="Settings tabs">
			<button class="tab active" role="tab" aria-selected="true" data-tab="main">Main</button>
			<button class="tab" role="tab" aria-selected="false" data-tab="ui">UI & Sounds</button>
			<button class="tab" role="tab" aria-selected="false" data-tab="auto">Auto Odds</button>
			<button class="tab" role="tab" aria-selected="false" data-tab="control">Control</button>
			<button class="tab" role="tab" aria-selected="false" data-tab="updates">Updates</button>
			<button class="tab" role="tab" aria-selected="false" data-tab="help">Help</button>
			<button class="tab" role="tab" aria-selected="false" data-tab="about">About</button>
		</nav>

		<div class="content">
			<!-- ============ MAIN TAB ============ -->
			<div class="tab-content active" data-tab="main" role="tabpanel">
				<div class="segmentsScroll">
					<section class="seg">
					<h2 class="sectionTitle">Game</h2>
					<div class="grid formGrid">
						<label for="game-select">Select game</label>
						<select id="game-select">
							<option value="lol">League of Legends</option>
							<option value="cs2">CS2</option>
							<option value="dota2">Dota 2</option>
						</select>
					</div>
					<div class="hint">This setting is applied globally. Listeners receive an event and can adjust parsers and UI.</div>
					</section>

					<section class="seg">
					<h2 class="sectionTitle">Broker Refresh</h2>
					<div class="grid formGrid">
						<label for="br-reselect-enabled">Map reselect (periodic)
							<small class="labelHint">Periodically re-click map tabs to ensure correct odds</small>
						</label>
						<input id="br-reselect-enabled" type="checkbox" checked />
						<label for="br-reselect-interval">Reselect interval</label>
						<div class="rangeWrap">
							<input id="br-reselect-interval" type="range" min="5" max="60" step="5" value="10" />
							<span id="br-reselect-interval-val" class="rangeVal">10s</span>
						</div>
						<div class="subRule" aria-hidden="true"></div>
						<label for="br-reload-enabled">Auto reload stale brokers
							<small class="labelHint">Reload broker page if odds missing or unchanged</small>
						</label>
						<input id="br-reload-enabled" type="checkbox" checked />
						<label for="br-missing-timeout">Missing odds timeout
							<small class="labelHint">Reload if odds are '-' for this long</small>
						</label>
						<div class="rangeWrap">
							<input id="br-missing-timeout" type="range" min="1" max="10" step="1" value="1" />
							<span id="br-missing-timeout-val" class="rangeVal">1 min</span>
						</div>
						<label for="br-unchanged-timeout">Unchanged odds timeout
							<small class="labelHint">Reload if odds haven't changed for this long</small>
						</label>
						<div class="rangeWrap">
							<input id="br-unchanged-timeout" type="range" min="1" max="10" step="1" value="3" />
							<span id="br-unchanged-timeout-val" class="rangeVal">3 min</span>
						</div>
					</div>
					<div class="hint">Map reselect periodically re-clicks map tabs (useful for SPAs). Auto reload refreshes broker pages when odds go stale or missing. These features work when the ‚ü≥ button is active.</div>
					</section>

				</div>
			</div>

			<!-- ============ UI TAB ============ -->
			<div class="tab-content" data-tab="ui" role="tabpanel" hidden>
				<div class="segmentsScroll">
					<section class="seg">
					<h2 class="sectionTitle">Stats Table</h2>
					<div class="grid formGrid">
						<label for="st-winlose">Win/Lose highlight</label><input id="st-winlose" type="checkbox" />
					</div>
					<div class="hint">Win/Lose highlight updates instantly.</div>
					</section>

					<section class="seg">
					<h2 class="sectionTitle">Table Animations</h2>
					<div class="grid formGrid">
						<label for="anim-enabled">Animations enabled</label><input id="anim-enabled" type="checkbox" />
						<label for="anim-duration">Duration (ms)</label><input id="anim-duration" type="number" min="50" max="5000" step="10" />
						<label for="anim-scale">Scale</label><input id="anim-scale" type="range" min="0.25" max="2" step="0.05" />
						<label for="anim-color1">Primary color</label><input id="anim-color1" type="color" />
						<label for="anim-color2">Secondary color</label><input id="anim-color2" type="color" />
					</div>
					<div class="hint">Animations are currently minimal (the framework is in place). Settings are saved for future effects.</div>
					</section>

					<section class="seg">
					<h2 class="sectionTitle">Activity Heat Bar</h2>
					<div class="grid formGrid">
						<label for="hb-enabled">Enabled</label><input id="hb-enabled" type="checkbox" />
						<label for="hb-decay">Fade time</label>
						<div class="rangeWrap">
							<input id="hb-decay" type="range" min="1" max="10" step="0.5" value="5" />
							<span id="hb-decay-val" class="rangeVal">5s</span>
						</div>
						<label for="hb-bump">Bump amount</label>
						<div class="rangeWrap">
							<input id="hb-bump" type="range" min="10" max="50" step="2" value="22" />
							<span id="hb-bump-val" class="rangeVal">22%</span>
						</div>
						<label for="hb-color1">Team 1 color</label><input id="hb-color1" type="color" />
						<label for="hb-color2">Team 2 color</label><input id="hb-color2" type="color" />
						<label for="hb-opacity">Opacity</label><input id="hb-opacity" type="range" min="0" max="1" step="0.01" />
					</div>
					<div class="hint">Activity bar: increases on events, decays over time. Colors blend; opacity scales max intensity.</div>
					</section>

					<section class="seg">
					<h2 class="sectionTitle">Sound Notifications</h2>
					<div class="grid formGrid">
						<label for="sounds-enabled">Enable sounds
							<small class="labelHint">Play sounds for match events (first blood, towers, etc.)</small>
						</label>
						<input id="sounds-enabled" type="checkbox" checked />
						<label for="sounds-volume">Volume</label>
						<div class="rangeWrap">
							<input id="sounds-volume" type="range" min="0" max="100" step="5" value="70" />
							<span id="sounds-volume-val" class="rangeVal">70%</span>
						</div>
					</div>
					<div class="hint">Sounds play for game start (based on ban phase), first blood, first tower, quadra and penta kills. Volume adjusts all notification sounds.</div>
					</section>
				</div>
			</div>

			<!-- ============ AUTO ODDS TAB ============ -->
			<div class="tab-content" data-tab="auto" role="tabpanel" hidden>
				<div class="segmentsScroll">
					<section class="seg">
					<h2 class="sectionTitle">Auto Odds</h2>
					<div class="grid formGrid">
						<!-- Core Settings -->
						<h3 class="subsectionTitle">‚öôÔ∏è Core</h3>
						<label for="auto-tolerance">Tolerance (%)</label>
						<div class="rangeWrap">
							<input id="auto-tolerance" type="range" min="0.5" max="10" step="0.1" />
							<span id="auto-tolerance-val" class="rangeVal"></span>
						</div>
						<label for="auto-interval">Step interval (ms)
							<small class="labelHint">How often Auto checks alignment</small>
						</label>
						<div class="rangeWrap">
							<input id="auto-interval" type="range" min="120" max="2000" step="10" />
							<span id="auto-interval-val" class="rangeVal"></span>
						</div>
						<label for="auto-pulse-step">Pulse step (%)
							<small class="labelHint">Diff % per burst pulse (8-15); capped at 3 pulses</small>
						</label>
						<div class="rangeWrap">
							<input id="auto-pulse-step" type="range" min="8" max="15" step="1" />
							<span id="auto-pulse-step-val" class="rangeVal"></span>
						</div>

						<!-- Protection / Thresholds -->
						<h3 class="subsectionTitle">üõ°Ô∏è Protection</h3>
						<label for="auto-suspend-threshold">Auto Suspend threshold (%)
							<small class="labelHint">Pauses auto when diff ‚â• this; resumes at half</small>
						</label>
						<div class="rangeWrap">
							<input id="auto-suspend-threshold" type="range" min="15" max="80" step="1" />
							<span id="auto-suspend-threshold-val" class="rangeVal"></span>
						</div>
						<label for="auto-shock-threshold">Shock threshold (%)
							<small class="labelHint">Large odds shift detection (ARB protection)</small>
						</label>
						<div class="rangeWrap">
							<input id="auto-shock-threshold" type="range" min="40" max="120" step="1" />
							<span id="auto-shock-threshold-val" class="rangeVal"></span>
						</div>
						<label for="auto-stop-no-mid">Stop on no MID
							<small class="labelHint">Disable Auto when MID data unavailable</small>
						</label>
						<input id="auto-stop-no-mid" type="checkbox" checked />
						<label for="auto-resume-on-mid">Resume on MID
							<small class="labelHint">Auto-resume when MID becomes available</small>
						</label>
						<input id="auto-resume-on-mid" type="checkbox" checked />

						<!-- Timing Settings -->
						<h3 class="subsectionTitle">‚è±Ô∏è Timing</h3>
						<label for="auto-fire-cooldown">Fire cooldown (ms)
							<small class="labelHint">Min delay between keypresses</small>
						</label>
						<div class="rangeWrap">
							<input id="auto-fire-cooldown" type="range" min="100" max="3000" step="50" />
							<span id="auto-fire-cooldown-val" class="rangeVal"></span>
						</div>
						<label for="auto-pulse-gap">Pulse gap (ms)
							<small class="labelHint">Delay between burst pulses</small>
						</label>
						<div class="rangeWrap">
							<input id="auto-pulse-gap" type="range" min="100" max="1000" step="50" />
							<span id="auto-pulse-gap-val" class="rangeVal"></span>
						</div>
					</div>
					<div class="hint">Tolerance: diff% below this considered aligned. Step interval: polling rate. Pulse step: each step adds one pulse (max 3). Suspend: pauses on large diff. Shock: ARB detection.</div>
					<div class="hint"><strong>Note:</strong> Excel/DS mode selection is on the Odds Board (Excel and DS buttons).</div>
					</section>
				</div>
			</div>

			<!-- ============ CONTROL TAB ============ -->
			<div class="tab-content" data-tab="control" role="tabpanel" hidden>
				<div class="segmentsScroll">
					<section class="seg">
					<h2 class="sectionTitle">Hotkeys</h2>
					<ul class="hotkeyList">
						<li><span class="hk">Tab</span> ‚Äî switch between Brokers and Stats</li>
						<li><span class="hk">F1</span> ‚Äî toggle Auto (works while the app window is active)</li>
						<li><span class="hk">F2</span> ‚Äî Auto Resume after Suspend (toggle)</li>
						<li><span class="hk">F3</span> ‚Äî start/stop Excel/Python script</li>
						<li><span class="hk">Num5</span> ‚Äî global (even outside the app) toggle Auto</li>
					</ul>
					<div class="hint">Tab/F1/F2/F3 are handled only when the app is active. Num5 is a global hotkey (if registered with the OS).</div>
					</section>
				</div>
			</div>

			<!-- ============ UPDATES TAB ============ -->
			<div class="tab-content" data-tab="updates" role="tabpanel" hidden>
				<div class="segmentsScroll">
					<section class="seg">
					<h2 class="sectionTitle">Updates</h2>
					<div class="grid formGrid">
						<label for="upd-channel">Update channel</label>
						<select id="upd-channel">
							<option value="stable">Stable (releases)</option>
							<option value="dev">Dev (commits)</option>
						</select>
						<label for="upd-auto">Check on startup</label>
						<input id="upd-auto" type="checkbox" />
						<label>Current version</label>
						<span id="upd-version" class="staticVal">‚Äî</span>
						<label>Status</label>
						<span id="upd-status" class="staticVal">‚Äî</span>
					</div>
					<div class="updateActions">
						<button id="upd-check" type="button">Check for Updates</button>
						<button id="upd-download" type="button" disabled>Download &amp; Install</button>
					</div>
					<div id="upd-progress" class="progress" hidden>
						<div class="bar"></div>
					</div>
					<div class="hint">Stable channel updates when new release tags (v*) are published. Dev channel updates on every commit to main branch.</div>
					</section>

					<section class="seg">
					<h2 class="sectionTitle">Dev</h2>
					<div class="grid formGrid">
						<label>DevTools</label>
						<button id="open-devtools" type="button">Open DevTools</button>
						<label>Main Window</label>
						<button id="open-main-devtools" type="button">Main Window DevTools</button>
						<label>User Data</label>
						<button id="open-userdata" type="button">Open Folder</button>
					</div>
					<div class="hint">DevTools opens board console. Main Window opens renderer console. User Data folder contains logs and settings.</div>
					</section>

					<section class="seg">
					<h2 class="sectionTitle">Edge Extension</h2>
					<div class="grid formGrid">
						<label>Status</label>
						<span id="ext-status" class="staticVal">‚Äî</span>
						<label>Extension version</label>
						<span id="ext-version" class="staticVal">‚Äî</span>
					</div>
					<div class="updateActions">
						<button id="ext-open-folder" type="button">Open Extension Folder</button>
					</div>
					<div class="hint">To install: Open Edge ‚Üí edge://extensions/ ‚Üí Enable Developer mode ‚Üí Load unpacked ‚Üí Select the folder above.</div>
					</section>

					<section class="seg">
					<h2 class="sectionTitle">Addons</h2>
					<div class="addons-container">
						<div class="addons-actions">
							<button id="addons-refresh" type="button" class="btn-secondary">
								<span class="btn-icon">üîÑ</span> Refresh
							</button>
							<button id="addons-open-folder" type="button" class="btn-secondary">
								<span class="btn-icon">üìÅ</span> Open Folder
							</button>
							<div class="addon-channel-selector">
								<label for="addon-channel">Channel:</label>
								<select id="addon-channel">
									<option value="dev">Dev (latest)</option>
									<option value="release">Release (stable)</option>
								</select>
							</div>
						</div>
						<div id="addons-list" class="addons-list">
							<div class="addons-loading">Loading addons...</div>
						</div>
						<div id="addons-available" class="addons-available">
							<h3 class="addons-subtitle">Available to Install</h3>
							<div id="addons-available-list"></div>
						</div>
					</div>
					<div class="hint">Addons extend app functionality. After installing or enabling/disabling, restart the app to apply changes.</div>
					</section>
				</div>
			</div>

			<!-- ============ HELP TAB ============ -->
			<div class="tab-content" data-tab="help" role="tabpanel" hidden>
				<div class="segmentsScroll">
					<section class="seg">
					<h2 class="sectionTitle">Overview</h2>
					<div class="helpBlock">
						<p>OddsMoni opens multiple bookmaker sites as embedded panels, automatically extracts live odds, and aggregates them on the Odds Board. The board shows <strong>Best</strong>, <strong>MID</strong> (average), and <strong>ARB</strong> (arbitrage) values across all active brokers.</p>
					</div>
					</section>

					<section class="seg">
					<h2 class="sectionTitle">View Switching</h2>
					<div class="helpBlock">
						<p>The app has two main views:</p>
						<p><strong>Brokers view</strong> ‚Äî bookmaker sites with live odds extraction.</p>
						<p><strong>Stats view</strong> ‚Äî two slots (A/B) for streams (e.g. Twitch) and live game stats from Grid. If Grid is available, match statistics (gold diff, kills, towers, dragons, barons) are displayed in real time.</p>
						<p>Press <span class="hk">Tab</span> to switch between these views. The Odds Board sidebar remains visible in both.</p>
					</div>
					</section>

					<section class="seg">
					<h2 class="sectionTitle">Auto Mode</h2>
					<div class="helpBlock">
						<p>Auto Mode continuously compares MID odds (from brokers) with target odds and sends virtual keystrokes to adjust the target.</p>
						<p><strong>Requirements to work:</strong></p>
						<ul class="helpList">
							<li>Live odds from at least 2 brokers (to compute MID)</li>
							<li>A target source ‚Äî either <strong>Excel</strong> (via Python script) or <strong>DS Extension</strong></li>
						</ul>
						<p>Toggle: <span class="hk">F1</span> (app focused) or <span class="hk">Num5</span> (global, works even when app is in background). Configure tolerance, thresholds, and timing in the <strong>Auto Odds</strong> tab.</p>
						<p><strong>Guards</strong> automatically block or pause Auto when conditions aren't met: Excel off, no MID data, DS disconnected, map mismatch, or ARB spike. Auto resumes automatically when the condition clears.</p>
					</div>
					</section>

					<section class="seg">
					<h2 class="sectionTitle">Excel &amp; DS Integration</h2>
					<div class="helpBlock">
						<p><strong>Excel mode:</strong> Press <span class="hk">F3</span> to start the Python script that reads odds and team names from an open Excel workbook. Status indicator shows the script state (Off / Starting / Active / Frozen).</p>
						<p><strong>DS mode:</strong> Works without Excel. Requires the Edge Extension connected via WebSocket. The extension reads odds from the DS page and sends them to OddsMoni. Commands (adjust up/down, commit) are sent back to the extension which clicks buttons on the DS page.</p>
						<p>Excel and DS are mutually exclusive ‚Äî select the active mode on the Odds Board (Excel / DS buttons).</p>
					</div>
					</section>

					<section class="seg">
					<h2 class="sectionTitle">Sounds &amp; Notifications</h2>
					<div class="helpBlock">
						<p>Audio alerts for LoL match events: game start (detected via ban phase), first blood, first tower, first baron, quadra/penta kills. Configure in the <strong>UI &amp; Sounds</strong> tab.</p>
					</div>
					</section>

					<section class="seg">
					<h2 class="sectionTitle">Hotkeys</h2>
					<table class="helpTable">
						<tr><td><span class="hk">Tab</span></td><td>Switch between Brokers and Stats views</td></tr>
						<tr><td><span class="hk">F1</span></td><td>Toggle Auto Mode (app focused)</td></tr>
						<tr><td><span class="hk">Num5</span></td><td>Toggle Auto Mode (global)</td></tr>
						<tr><td><span class="hk">F2</span></td><td>Resume Auto after suspend</td></tr>
						<tr><td><span class="hk">F3</span></td><td>Start / stop Excel Python script</td></tr>
						<tr><td><span class="hk">F12</span></td><td>DevTools for active broker</td></tr>

					</table>
					<div class="hint">Tab/F1/F2/F3 require app focus. Num5 works globally if registered with the OS.</div>
					</section>

					<section class="seg">
					<h2 class="sectionTitle">Troubleshooting</h2>
					<div class="helpBlock">
						<p><strong>Odds not appearing:</strong> Wait for the broker page to fully load. Use ‚ü≥ reselect or increase the missing odds timeout in <strong>Main ‚Üí Broker Refresh</strong>.</p>
						<p><strong>Auto won't start:</strong> Check that at least 2 brokers provide odds (MID available) and that Excel or DS is active. Guard indicators on the board show the blocking reason.</p>
						<p><strong>DS Extension not connecting:</strong> Verify the extension is loaded in Edge (edge://extensions/, Developer mode) and OddsMoni's WebSocket bridge is running (port 9876).</p>
						<p><strong>Stale odds / wrong map:</strong> Enable Map Reselect in <strong>Main ‚Üí Broker Refresh</strong>. For BetBoom, a 3-second grace period after reload suppresses stale data automatically.</p>
					</div>
					</section>
				</div>
			</div>

			<!-- ============ ABOUT TAB ============ -->
			<div class="tab-content" data-tab="about" role="tabpanel" hidden>
				<div class="segmentsScroll">
					<section class="seg aboutCenter">
					<div class="aboutLogo">üìä</div>
					<h2 class="aboutTitle">OddsMoni</h2>
					<p class="aboutVersion" id="about-version">Version ‚Äî</p>
					<p class="aboutDesc">Electron-based desktop application for real-time odds monitoring, aggregation, and automated trading across multiple bookmaker platforms.</p>
					</section>

					<section class="seg">
					<h2 class="sectionTitle">Features</h2>
					<ul class="aboutFeatures">
						<li>Multi-broker odds extraction and normalization</li>
						<li>Automated trading with Excel and DS integration</li>
						<li>Live LoL game stats with sound notifications</li>
						<li>Addon/plugin system for extensions</li>
						<li>Auto-update system (dev/stable channels)</li>
					</ul>
					</section>

					<section class="seg">
					<h2 class="sectionTitle">Links</h2>
					<div class="grid formGrid">
						<label>GitHub</label>
						<span class="staticVal aboutLink" data-url="https://github.com/MrLordCat/TraderData-and-odds-Monitor">Repository ‚Üó</span>
					</div>
					</section>
				</div>
			</div>

		</div>
		<div class="foot">
			<button id="reset">Reset</button>
			<button id="save" class="primary">Save</button>
		</div>
	</div>
	<script src="../scripts/theme_settings.js"></script>
	<script src="../dist/settings.bundle.js"></script>
</body>
</html>
